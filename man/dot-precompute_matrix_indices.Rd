% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/structural-conversion.R
\name{.precompute_matrix_indices}
\alias{.precompute_matrix_indices}
\title{Precompute indices from aggregation indicator matrix}
\usage{
.precompute_matrix_indices(matrix)
}
\arguments{
\item{matrix}{A binary indicator matrix (0s and 1s) where each row
indicates which columns should be aggregated together.}
}
\value{
A list with two components:
\itemize{
\item \code{n_selected}: Integer vector of length \code{nrow(matrix)} containing the
number of selected (non-zero) indices per row
\item \code{selected_idx}: Integer matrix of dimensions \verb{[nrow(matrix), ncol(matrix)]}
containing the column indices where each row has 1s, with unused
positions filled with 0
}
}
\description{
Extracts the column indices where each row of a binary indicator matrix
has 1s. This is used for numerically stable aggregation operations in Stan.
}
\details{
This helper function is primarily used in tests and by
\code{.convert_structural_to_arrays()} to precompute sparse index lookups for
aggregation operations.
}
\keyword{internal}

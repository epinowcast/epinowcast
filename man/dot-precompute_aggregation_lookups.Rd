% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/structural-conversion.R
\name{.precompute_aggregation_lookups}
\alias{.precompute_aggregation_lookups}
\title{Precompute aggregation index lookups for Stan}
\usage{
.precompute_aggregation_lookups(structural, n_groups, n_times, max_delay)
}
\arguments{
\item{structural}{A nested list structure: list(groups) of list(times) of
matrices (max_delay x max_delay). Each matrix contains 0s and 1s
indicating which delays aggregate to which reporting delays.}

\item{n_groups}{Integer number of groups.}

\item{n_times}{Integer number of time points.}

\item{max_delay}{Integer maximum delay.}
}
\value{
A list with two components:
\itemize{
\item \code{n_selected}: 3D array \link{groups, times, max_delay} containing the
number of selected indices per row
\item \code{selected_idx}: 4D array \link{groups, times, max_delay, max_delay}
containing the column indices where each row has 1s
}
}
\description{
Takes a nested list structure of aggregation indicator matrices and
precomputes sparse index lookups for efficient Stan operations.
}
\details{
Row i of the precomputed indices only contains column indices j where
j <= i, ensuring reports aggregate from current or earlier delays only.
}
\keyword{internal}

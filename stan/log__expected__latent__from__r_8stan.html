<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>epinowcast: log_expected_latent_from_r.stan File Reference</title>
<link rel="icon" href="logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">epinowcast
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('log__expected__latent__from__r_8stan.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">log_expected_latent_from_r.stan File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="log__expected__latent__from__r_8stan_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a012e6547e1e583e24b73b6611076dda4" id="r_a012e6547e1e583e24b73b6611076dda4"><td class="memItemLeft" align="right" valign="top">vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a012e6547e1e583e24b73b6611076dda4">extract_group_rates</a> (vector r, array[] int r_g, int k, int r_t)</td></tr>
<tr class="separator:a012e6547e1e583e24b73b6611076dda4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94b5723677737336dce68db1d4500d43" id="r_a94b5723677737336dce68db1d4500d43"><td class="memItemLeft" align="right" valign="top">array[] vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94b5723677737336dce68db1d4500d43">log_expected_latent_from_r</a> (matrix lexp_latent_int, vector r, array[] int r_g, int r_t, int r_seed, int gt_n, vector lrgt, int t, int g)</td></tr>
<tr class="separator:a94b5723677737336dce68db1d4500d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a012e6547e1e583e24b73b6611076dda4" name="a012e6547e1e583e24b73b6611076dda4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012e6547e1e583e24b73b6611076dda4">&#9670;&#160;</a></span>extract_group_rates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector extract_group_rates </td>
          <td>(</td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]int</td>          <td class="paramname"><span class="paramname"><em>r_g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>r_t</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extract log growth rates for a specific group</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>Vector of all group growth rates concatenated. </td></tr>
    <tr><td class="paramname">r_g</td><td>Array of indices marking the start of each group in r. </td></tr>
    <tr><td class="paramname">k</td><td>Group index (1-indexed). </td></tr>
    <tr><td class="paramname">r_t</td><td>Number of time periods.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of log growth rates for group k. </dd></dl>

<p class="definition">Definition at line <a class="el" href="log__expected__latent__from__r_8stan_source.html#l00011">11</a> of file <a class="el" href="log__expected__latent__from__r_8stan_source.html">log_expected_latent_from_r.stan</a>.</p>

</div>
</div>
<a id="a94b5723677737336dce68db1d4500d43" name="a94b5723677737336dce68db1d4500d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94b5723677737336dce68db1d4500d43">&#9670;&#160;</a></span>log_expected_latent_from_r()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">array[] vector log_expected_latent_from_r </td>
          <td>(</td>
          <td class="paramtype">matrix</td>          <td class="paramname"><span class="paramname"><em>lexp_latent_int</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]int</td>          <td class="paramname"><span class="paramname"><em>r_g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>r_t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>r_seed</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>gt_n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector</td>          <td class="paramname"><span class="paramname"><em>lrgt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>g</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Iteratively compute expected latent values using the renewal equation</p>
<p>This function calculates expected latent values over time for different groups using the renewal equation. It's designed to handle scenarios where the generation time is represented either as a constant (leading to exponential growth) or as a vector (requiring a dot product calculation). The function operates on the natural scale for stability and then transforms the results back to the log scale when the generation time is a vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lexp_latent_int</td><td>Matrix of initial log expected latent values.</td></tr>
    <tr><td class="paramname">r</td><td>Vector representing growth rate or the log of the effective reproduction number.</td></tr>
    <tr><td class="paramname">r_g</td><td>Array of indices marking the start of each group in the rate vector. </td></tr>
    <tr><td class="paramname">r_t</td><td>Number of time periods for rate adjustments.</td></tr>
    <tr><td class="paramname">r_seed</td><td>Seed time period for rate-based adjustments.</td></tr>
    <tr><td class="paramname">gt_n</td><td>Length of the generation time vector (1 for constant generation time).</td></tr>
    <tr><td class="paramname">lrgt</td><td>Log of the generation time vector or scalar.</td></tr>
    <tr><td class="paramname">t</td><td>Total number of time periods.</td></tr>
    <tr><td class="paramname">g</td><td>Number of groups.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An array of vectors containing log-transformed expected latent values for each group and time period.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function performs the following operations:<ol type="1">
<li>For each group: a. Extracts a segment of rates specific to the current group. b. If 'gt_n' is 1 (constant generation time), directly applies a cumulative sum on the log scale to model exponential growth. c. If 'gt_n' &gt; 1 (vector generation time): i. Converts the log rate and log initial latent values to the natural scale. ii. Uses a dot product with the generation time vector for each time point, following the renewal equation. iii. Converts the resulting expected values back to the log scale, as this approach is expected to be more numerically stable than performing the renewal equation directly in log space. </li>
</ol>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="log__expected__latent__from__r_8stan_source.html#l00063">63</a> of file <a class="el" href="log__expected__latent__from__r_8stan_source.html">log_expected_latent_from_r.stan</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_35baea09d55bebfe17654fdf4bf061ce.html">functions</a></li><li class="navelem"><a class="el" href="log__expected__latent__from__r_8stan.html">log_expected_latent_from_r.stan</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Distributions and their discretisation in epinowcast">
<title>Discretised distributions • epinowcast</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Discretised distributions">
<meta property="og:description" content="Distributions and their discretisation in epinowcast">
<meta property="og:image" content="package.epinowcast.org/reference/figures/README-nowcast-1.png">
<meta property="og:image:alt" content="An R package for flexible hierarchical nowcasting">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@seabbs">
<meta name="twitter:site" content="@seabbs">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epinowcast</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.3.2000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/epinowcast.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Model details</h6>
    <a class="dropdown-item" href="../articles/model.html">Model definition and implementation</a>
    <a class="dropdown-item" href="../articles/distributions.html">Discretised distributions</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Case studies</h6>
    <a class="dropdown-item" href="../articles/germany-age-stratified-nowcasting.html">Hierarchical nowcasting of age stratified COVID-19 hospitalisations in Germany</a>
    <a class="dropdown-item" href="../articles/single-timeseries-rt-estimation.html">Estimating the effective reproduction number in real-time for a single timeseries with reporting delays</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epinowcast/epinowcast/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Discretised distributions</h1>
                        <h4 data-toc-skip class="author">Sam Abbott,
Adrian Lison, Felix Günther</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/epinowcast/blob/HEAD/vignettes/distributions.Rmd" class="external-link"><code>vignettes/distributions.Rmd</code></a></small>
      <div class="d-none name"><code>distributions.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the parametric delay distributions that are
currently available in <code>epinowcast</code> and explains how they are
internally discretised.</p>
<div class="section level2">
<h2 id="available-distributions">Available distributions<a class="anchor" aria-label="anchor" href="#available-distributions"></a>
</h2>
<p>The currently available parametric delay distributions are continuous
probability distributions with (up to) two parameters <span class="math inline">\(\mu_{g,t}\)</span> and <span class="math inline">\(\upsilon_{g,t}\)</span>. The table below provides
a link to the definition of each distribution, specifies how the
parameters <span class="math inline">\(\mu_{g,t}\)</span> and <span class="math inline">\(\upsilon_{g,t}\)</span> are mapped to the
parameters of the distribution (according to the referenced definition),
and states the resulting mean of the distribution (before discretization
and adjustment for the assumed maximum delay).</p>
<table class="table">
<colgroup>
<col width="32%">
<col width="28%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th align="center">Distribution</th>
<th align="center">Parametrization</th>
<th align="center">Mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><a href="https://mc-stan.org/docs/functions-reference/lognormal.html" class="external-link">Log-normal</a></td>
<td align="center">
<span class="math inline">\(\mu=\mu_{g,t}\)</span>,
<span class="math inline">\(\sigma = \upsilon_{g,t}\)</span>
</td>
<td align="center"><span class="math inline">\(\exp(\mu_{g,t}+\frac{\upsilon_{g,t}^2}{2})\)</span></td>
</tr>
<tr class="even">
<td align="center"><a href="https://mc-stan.org/docs/functions-reference/exponential-distribution.html" class="external-link">Exponential</a></td>
<td align="center"><span class="math inline">\(\beta =
\exp(-\mu_{g,t})\)</span></td>
<td align="center"><span class="math inline">\(\exp(\mu_{g,t})\)</span></td>
</tr>
<tr class="odd">
<td align="center"><a href="https://mc-stan.org/docs/functions-reference/gamma-distribution.html" class="external-link">Gamma</a></td>
<td align="center">
<span class="math inline">\(\alpha =
\exp(\mu_{g,t})\)</span>, <span class="math inline">\(\beta =
\upsilon_{g,t}\)</span>
</td>
<td align="center"><span class="math inline">\(\exp(\mu_{g,t})/\upsilon_{g,t}\)</span></td>
</tr>
<tr class="even">
<td align="center"><a href="https://en.wikipedia.org/wiki/Log-logistic_distribution" class="external-link">Log-logistic</a></td>
<td align="center">
<span class="math inline">\(\alpha =
\exp(\mu_{g,t})\)</span>, <span class="math inline">\(\beta =
\upsilon_{g,t}\)</span>
</td>
<td align="center"><span class="math inline">\(\frac{\exp(\mu_{g,t})\,\pi/\upsilon_{g,t}}{\sin(\pi/\upsilon_{g,t})}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="discretisation-and-adjustment-for-maximum-delay">Discretisation and adjustment for maximum delay<a class="anchor" aria-label="anchor" href="#discretisation-and-adjustment-for-maximum-delay"></a>
</h2>
<p>In <code>epinowcast</code>, delays are modeled in discrete time and
with an assumed maximum delay (specified via the <code>max_delay</code>
argument). Therefore, the continuous delay distributions must be
discretised and adjusted for the maximum delay.</p>
<p>The exact form of this discretisation is complex due to the
interaction between primary and secondary events. Rather than modelling
this explicitly, we approximate it by assuming a uniform censoring
interval of 2 days for each delay. This comes from assuming daily
censoring of both the primary and secondary events, which together
define the delay distribution, and ignoring potential interactions
between primary and secondary events. As a result, the probability of
reporting a delay of <span class="math inline">\(d\)</span> days equals
the probability of reporting a delay of <span class="math inline">\(d+1\)</span> days or less, minus the probability
of reporting a delay of <span class="math inline">\(d-1\)</span> days or
less. This is then normalised by the overall probability of reporting
any delay up to some maximum observed delay, <span class="math inline">\(D\)</span>.</p>
<p>More formally, we define this in terms of the cumulative distribution
function of the delay distribution. Let <span class="math inline">\(F^{\mu_{g,t}, \upsilon_{g,t}}\)</span> be the
cumulative distribution function of a continuous probability
distribution of delays with parameters <span class="math inline">\(\mu_{g,t}\)</span> and <span class="math inline">\(\upsilon_{g,t}\)</span>. Then, the probability of
reporting a delay of <span class="math inline">\(d\)</span> days is
<span class="math display">\[p_{g,t,d} = \frac{F^{\mu_{g,t},
\upsilon_{g,t}}(d+1) - F^{\mu_{g,t}, \upsilon_{g,t}}(d-1)}{F^{\mu_{g,t},
\upsilon_{g,t}}(D + 1 ) + F^{\mu_{g,t},
\upsilon_{g,t}}(D)}.\]</span></p>
<p>Unless <span class="math inline">\(d = 0\)</span> then we instead
have</p>
<p><span class="math display">\[p_{g,t,0} = \frac{F^{\mu_{g,t},
\upsilon_{g,t}}(1)}{F^{\mu_{g,t}, \upsilon_{g,t}}(D + 1 ) +
F^{\mu_{g,t}, \upsilon_{g,t}}(D)}.\]</span></p>
<p>Normalising by <span class="math inline">\(F^{\mu_{g,t},
\upsilon_{g,t}}(D+1) + F^{\mu_{g,t}, \upsilon_{g,t}}(D)\)</span>,
ensures that the <span class="math inline">\(p^{\prime}_{g,t,d}\)</span>
sum to 1. Since <span class="math inline">\(F^{\mu_{g,t},
\upsilon_{g,t}}(D)\)</span> is the probability of reporting before the
maximum delay, this can also be interpreted as conditioning our
distribution on the maximum delay.</p>
<p>Note that because of the discretisation and normalization, the
discrete delay distribution we obtain only approximates the original
continuous distribution, and the approximation is worse for shorter
delays.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Adrian Lison, Sebastian Funk, Carl Pearson, Hugo Gruson, Felix Guenther.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

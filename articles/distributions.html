<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Discretised distributions • epinowcast</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Discretised distributions">
<meta name="description" content="Distributions and their discretisation in epinowcast">
<meta property="og:description" content="Distributions and their discretisation in epinowcast">
<meta property="og:image" content="https://package.epinowcast.org/reference/figures/README-nowcast-1.png">
<meta property="og:image:alt" content="An R package for flexible hierarchical nowcasting">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@seabbs">
<meta name="twitter:site" content="@seabbs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epinowcast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/epinowcast.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reference" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reference</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reference">
<li><a class="dropdown-item" href="../reference/index.html">R Reference</a></li>
    <li><a class="dropdown-item" href="https://package.epinowcast.org/stan/globals.html">Stan Reference</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Model details</h6></li>
    <li><a class="dropdown-item" href="../articles/model.html">Model definition and implementation</a></li>
    <li><a class="dropdown-item" href="../articles/features.html">Model features summary</a></li>
    <li><a class="dropdown-item" href="../articles/distributions.html">Discretised distributions</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Case studies</h6></li>
    <li><a class="dropdown-item" href="../articles/germany-age-stratified-nowcasting.html">Hierarchical nowcasting of age stratified COVID-19 hospitalisations in Germany</a></li>
    <li><a class="dropdown-item" href="../articles/single-timeseries-rt-estimation.html">Estimating the effective reproduction number in real-time for a single timeseries with reporting delays</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Working with epinowcast</h6></li>
    <li><a class="dropdown-item" href="../articles/stan-help.html">Resources to help with model fitting using Stan</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epinowcast/epinowcast/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Discretised distributions</h1>
                        <h4 data-toc-skip class="author">Epinowcast
Team</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/epinowcast/blob/main/vignettes/distributions.Rmd" class="external-link"><code>vignettes/distributions.Rmd</code></a></small>
      <div class="d-none name"><code>distributions.Rmd</code></div>
    </div>

    
    
<p>This vignette describes the parametric delay distributions that are
currently available in <code>epinowcast</code> and explains how they are
internally discretised.</p>
<div class="section level2">
<h2 id="available-distributions">Available distributions<a class="anchor" aria-label="anchor" href="#available-distributions"></a>
</h2>
<p>The currently available parametric delay distributions are continuous
probability distributions with (up to) two parameters <span class="math inline">\(\mu_{g,t}\)</span> and <span class="math inline">\(\upsilon_{g,t}\)</span>. The table below provides
a link to the definition of each distribution, specifies how the
parameters <span class="math inline">\(\mu_{g,t}\)</span> and <span class="math inline">\(\upsilon_{g,t}\)</span> are mapped to the
parameters of the distribution (according to the referenced definition),
and states the resulting mean of the distribution (before discretization
and adjustment for the assumed maximum delay).</p>
<table class="table">
<colgroup>
<col width="32%">
<col width="28%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th align="center">Distribution</th>
<th align="center">Parametrization</th>
<th align="center">Mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><a href="https://mc-stan.org/docs/functions-reference/lognormal.html" class="external-link">Log-normal</a></td>
<td align="center">
<span class="math inline">\(\mu=\mu_{g,t}\)</span>,
<span class="math inline">\(\sigma = \upsilon_{g,t}\)</span>
</td>
<td align="center"><span class="math inline">\(\exp(\mu_{g,t}+\frac{\upsilon_{g,t}^2}{2})\)</span></td>
</tr>
<tr class="even">
<td align="center"><a href="https://mc-stan.org/docs/functions-reference/exponential-distribution.html" class="external-link">Exponential</a></td>
<td align="center"><span class="math inline">\(\beta =
\exp(-\mu_{g,t})\)</span></td>
<td align="center"><span class="math inline">\(\exp(\mu_{g,t})\)</span></td>
</tr>
<tr class="odd">
<td align="center"><a href="https://mc-stan.org/docs/functions-reference/gamma-distribution.html" class="external-link">Gamma</a></td>
<td align="center">
<span class="math inline">\(\alpha =
\exp(\mu_{g,t})\)</span>, <span class="math inline">\(\beta =
\upsilon_{g,t}\)</span>
</td>
<td align="center"><span class="math inline">\(\exp(\mu_{g,t})/\upsilon_{g,t}\)</span></td>
</tr>
<tr class="even">
<td align="center"><a href="https://en.wikipedia.org/wiki/Log-logistic_distribution" class="external-link">Log-logistic</a></td>
<td align="center">
<span class="math inline">\(\alpha =
\exp(\mu_{g,t})\)</span>, <span class="math inline">\(\beta =
\upsilon_{g,t}\)</span>
</td>
<td align="center"><span class="math inline">\(\frac{\exp(\mu_{g,t})\,\pi/\upsilon_{g,t}}{\sin(\pi/\upsilon_{g,t})}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="discretisation-and-adjustment-for-maximum-delay">Discretisation and adjustment for maximum delay<a class="anchor" aria-label="anchor" href="#discretisation-and-adjustment-for-maximum-delay"></a>
</h2>
<p>In <code>epinowcast</code>, delays are modeled in discrete time and
with an assumed maximum delay (specified via the <code>max_delay</code>
argument). Therefore, the continuous delay distributions must be
discretised and adjusted for the maximum delay.</p>
<p>The exact form of this discretisation is complex due to the
interaction between primary and secondary events. Rather than modelling
this explicitly, we approximate it by assuming a uniform censoring
interval of 2 days for each delay. This comes from assuming daily
censoring of both the primary and secondary events, which together
define the delay distribution, and ignoring potential interactions
between primary and secondary events. As a result, the probability of
reporting a delay of <span class="math inline">\(d\)</span> days equals
the probability of reporting a delay of <span class="math inline">\(d+1\)</span> days or less, minus the probability
of reporting a delay of <span class="math inline">\(d-1\)</span> days or
less. This is then normalised by the overall probability of reporting
any delay up to some maximum observed delay, <span class="math inline">\(D\)</span>.</p>
<p>More formally, we define this in terms of the cumulative distribution
function of the delay distribution. Let <span class="math inline">\(F^{\mu_{g,t}, \upsilon_{g,t}}\)</span> be the
cumulative distribution function of a continuous probability
distribution of delays with parameters <span class="math inline">\(\mu_{g,t}\)</span> and <span class="math inline">\(\upsilon_{g,t}\)</span>. Then, the probability of
reporting a delay of <span class="math inline">\(d\)</span> days is
<span class="math display">\[p_{g,t,d} = \frac{F^{\mu_{g,t},
\upsilon_{g,t}}(d+1) - F^{\mu_{g,t}, \upsilon_{g,t}}(d-1)}{F^{\mu_{g,t},
\upsilon_{g,t}}(D + 1 ) + F^{\mu_{g,t},
\upsilon_{g,t}}(D)}.\]</span></p>
<p>Unless <span class="math inline">\(d = 0\)</span> then we instead
have</p>
<p><span class="math display">\[p_{g,t,0} = \frac{F^{\mu_{g,t},
\upsilon_{g,t}}(1)}{F^{\mu_{g,t}, \upsilon_{g,t}}(D + 1 ) +
F^{\mu_{g,t}, \upsilon_{g,t}}(D)}.\]</span></p>
<p>Normalising by <span class="math inline">\(F^{\mu_{g,t},
\upsilon_{g,t}}(D+1) + F^{\mu_{g,t}, \upsilon_{g,t}}(D)\)</span>,
ensures that the <span class="math inline">\(p^{\prime}_{g,t,d}\)</span>
sum to 1. Since <span class="math inline">\(F^{\mu_{g,t},
\upsilon_{g,t}}(D)\)</span> is the probability of reporting before the
maximum delay, this can also be interpreted as conditioning our
distribution on the maximum delay.</p>
<p>Note that because of the discretisation and normalization, the
discrete delay distribution we obtain only approximates the original
continuous distribution, and the approximation is worse for shorter
delays.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Adrian Lison, Sebastian Funk, Carl Pearson, Hugo Gruson, Felix Guenther, Michael DeWitt, James Mba Azam, Jessalyn Sebastian.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>

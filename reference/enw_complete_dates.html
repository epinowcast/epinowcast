<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Complete missing reference and report dates — enw_complete_dates • epinowcast</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Complete missing reference and report dates — enw_complete_dates"><meta property="og:description" content="Ensures that all reference and report dates are present for
all groups based on the maximum and minimum dates found in the data.
This function may be of use to users when preprocessing their data. In
general all features that you may consider using as grouping variables
or as covariates need to be included in the by variable."><meta property="og:image" content="https://package.epinowcast.org/reference/figures/README-nowcast-1.png"><meta property="og:image:alt" content="An R package for flexible hierarchical nowcasting"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@seabbs"><meta name="twitter:site" content="@seabbs"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epinowcast</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/epinowcast.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li class="dropdown-header">Model details</li>
    <li>
      <a href="../articles/model.html">Model definition and implementation</a>
    </li>
    <li>
      <a href="../articles/distributions.html">Discretised distributions</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Case studies</li>
    <li>
      <a href="../articles/germany-age-stratified-nowcasting.html">Hierarchical nowcasting of age stratified COVID-19 hospitalisations in Germany</a>
    </li>
    <li>
      <a href="../articles/single-timeseries-rt-estimation.html">Estimating the effective reproduction number in real-time for a single timeseries with reporting delays</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Working with epinowcast</li>
    <li>
      <a href="../articles/stan-help.html">Resources to help with model fitting using Stan</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/epinowcast/epinowcast/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Complete missing reference and report dates</h1>
    <small class="dont-index">Source: <a href="https://github.com/epinowcast/epinowcast/blob/HEAD/R/preprocess.R" class="external-link"><code>R/preprocess.R</code></a></small>
    <div class="hidden name"><code>enw_complete_dates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Ensures that all reference and report dates are present for
all groups based on the maximum and minimum dates found in the data.
This function may be of use to users when preprocessing their data. In
general all features that you may consider using as grouping variables
or as covariates need to be included in the <code>by</code> variable.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">enw_complete_dates</span><span class="op">(</span></span>
<span>  <span class="va">obs</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">max_delay</span>,</span>
<span>  min_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">reference_date</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  max_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">report_date</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  timestep <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>  missing_reference <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  completion_beyond_max_report <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  flag_observation <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obs</dt>
<dd><p>A <code>data.frame</code> containing at least the following variables:
<code>reference date</code> (index date of interest), <code>report_date</code> (report date for
observations), and <code>confirm</code> (cumulative observations by reference and report
date).</p></dd>


<dt>by</dt>
<dd><p>A character vector describing the stratification of
observations. This defaults to no grouping. This should be used
when modelling multiple time series in order to identify them for
downstream modelling</p></dd>


<dt>max_delay</dt>
<dd><p>The maximum number of days to model in the delay
distribution. Must be an integer greater than or equal to 1. Observations
with delays larger then the maximum delay will be dropped. If the specified
maximum delay is too short, nowcasts can be biased as important parts of the
true delay distribution are cut off. At the same time, computational cost
scales non-linearly with this setting, so you want the maximum delay to be as
long as necessary, but not much longer. Consider what delays are realistic
for your application, and when in doubt, check if increasing the maximum
delay noticeably changes the delay distribution or nowcasts as estimated by
epinowcast. If it does, your maximum delay may still be too short.
Note that delays are zero indexed and so include the reference date and
<code>max_delay - 1</code> other days (i.e. a <code>max_delay</code> of 1 corresponds to
no delay). You can use <code><a href="check_max_delay.html">check_max_delay()</a></code> to check the coverage of a delay
distribution for different maximum delays.</p></dd>


<dt>min_date</dt>
<dd><p>The minimum date to include in the data. Defaults to the
minimum reference date found in the data.</p></dd>


<dt>max_date</dt>
<dd><p>The maximum date to include in the data. Defaults to the
maximum report date found in the data.</p></dd>


<dt>timestep</dt>
<dd><p>The timestep to used. This can be a string ("day",
"week", "month") or a numeric whole number representing the number of days.</p></dd>


<dt>missing_reference</dt>
<dd><p>Logical, should entries for cases with missing
reference date be completed as well?, Default: TRUE</p></dd>


<dt>completion_beyond_max_report</dt>
<dd><p>Logical, should entries be completed
beyond the maximum date found in the data? Default: FALSE</p></dd>


<dt>flag_observation</dt>
<dd><p>Logical, should observations that have been
imputed as missing be flagged as not observed?. Makes use of
<code><a href="enw_flag_observed_observations.html">enw_flag_observed_observations()</a></code> to add a <code>.observed</code> logical vector
which indicates if observations have been imputed. This vector can
then be passed to the <code>observation_indicator</code> argument of <code><a href="enw_obs.html">enw_obs()</a></code> to
control if these observations are used in the likelihood. Default: FALSE</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>data.table</code> with completed entries for all combinations of
reference dates, groups and possible report dates.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Preprocessing functions
<code><a href="enw_add_delay.html">enw_add_delay</a>()</code>,
<code><a href="enw_add_max_reported.html">enw_add_max_reported</a>()</code>,
<code><a href="enw_add_metaobs_features.html">enw_add_metaobs_features</a>()</code>,
<code><a href="enw_assign_group.html">enw_assign_group</a>()</code>,
<code><a href="enw_construct_data.html">enw_construct_data</a>()</code>,
<code><a href="enw_extend_date.html">enw_extend_date</a>()</code>,
<code><a href="enw_filter_delay.html">enw_filter_delay</a>()</code>,
<code><a href="enw_filter_reference_dates.html">enw_filter_reference_dates</a>()</code>,
<code><a href="enw_filter_report_dates.html">enw_filter_report_dates</a>()</code>,
<code><a href="enw_flag_observed_observations.html">enw_flag_observed_observations</a>()</code>,
<code><a href="enw_impute_na_observations.html">enw_impute_na_observations</a>()</code>,
<code><a href="enw_latest_data.html">enw_latest_data</a>()</code>,
<code><a href="enw_metadata_delay.html">enw_metadata_delay</a>()</code>,
<code><a href="enw_metadata.html">enw_metadata</a>()</code>,
<code><a href="enw_missing_reference.html">enw_missing_reference</a>()</code>,
<code><a href="enw_preprocess_data.html">enw_preprocess_data</a>()</code>,
<code><a href="enw_reporting_triangle_to_long.html">enw_reporting_triangle_to_long</a>()</code>,
<code><a href="enw_reporting_triangle.html">enw_reporting_triangle</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  report_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-10-01"</span>, <span class="st">"2021-10-03"</span><span class="op">)</span>, reference_date <span class="op">=</span> <span class="st">"2021-10-01"</span>,</span></span>
<span class="r-in"><span>  confirm <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">enw_complete_dates</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;reference_date, report_date&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    report_date reference_date confirm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;IDat&gt;         &lt;IDat&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  2021-10-01           &lt;NA&gt;       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  2021-10-02           &lt;NA&gt;       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  2021-10-03           &lt;NA&gt;       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  2021-10-01     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:  2021-10-02     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:  2021-10-03     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:  2021-10-02     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8:  2021-10-03     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9:  2021-10-03     2021-10-03       0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Allow completion beyond the maximum date found in the data</span></span></span>
<span class="r-in"><span><span class="fu">enw_complete_dates</span><span class="op">(</span><span class="va">obs</span>, completion_beyond_max_report <span class="op">=</span> <span class="cn">TRUE</span>, max_delay <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;reference_date, report_date&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     report_date reference_date confirm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;IDat&gt;         &lt;IDat&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:  2021-10-01           &lt;NA&gt;       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:  2021-10-02           &lt;NA&gt;       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:  2021-10-03           &lt;NA&gt;       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:  2021-10-01     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:  2021-10-02     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:  2021-10-03     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:  2021-10-04     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:  2021-10-05     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:  2021-10-06     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:  2021-10-07     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:  2021-10-08     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:  2021-10-09     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:  2021-10-10     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:  2021-10-11     2021-10-01       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:  2021-10-02     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:  2021-10-03     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:  2021-10-04     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:  2021-10-05     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:  2021-10-06     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:  2021-10-07     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:  2021-10-08     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:  2021-10-09     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:  2021-10-10     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:  2021-10-11     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:  2021-10-12     2021-10-02       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26:  2021-10-03     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27:  2021-10-04     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28:  2021-10-05     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29:  2021-10-06     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30:  2021-10-07     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31:  2021-10-08     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32:  2021-10-09     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33:  2021-10-10     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34:  2021-10-11     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35:  2021-10-12     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36:  2021-10-13     2021-10-03       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     report_date reference_date confirm</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Adrian Lison, Sebastian Funk, Carl Pearson, Hugo Gruson, Felix Guenther, Michael DeWitt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

